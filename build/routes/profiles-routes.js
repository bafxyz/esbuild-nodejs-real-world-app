var a=Object.create,l=Object.defineProperty,c=Object.getPrototypeOf,R=Object.prototype.hasOwnProperty,m=Object.getOwnPropertyNames,h=Object.getOwnPropertyDescriptor,u=e=>l(e,"__esModule",{value:!0}),I=(e,o)=>{u(e);for(var t in o)l(e,t,{get:o[t],enumerable:!0})},F=(e,o,t)=>{if(u(e),o&&typeof o=="object"||typeof o=="function")for(let r of m(o))!R.call(e,r)&&r!=="default"&&l(e,r,{get:()=>o[r],enumerable:!(t=h(o,r))||t.enumerable});return e},p=e=>e&&e.__esModule?e:F(l(e!=null?a(c(e)):{},"default",{value:e,enumerable:!0}),e);I(exports,{ProfilesRoutes:()=>N});var d=p(require("express")),i=p(require("../database/models/user.model")),f=p(require("../utils/authentication"));const s=d.Router();s.param("username",(e,o,t,r)=>{i.User.findOne({username:r}).then(n=>(e.profile=n,t())).catch(t)}),s.get("/:username",f.authentication.optional,(e,o,t)=>{e.payload?i.User.findById(e.payload.id).then(r=>{o.status(200).json({profile:e.profile.toProfileJSONFor(r)})}).catch(t):o.status(200).json({profile:e.profile.toProfileJSONFor(e.profile)})}),s.post("/:username/follow",f.authentication.required,(e,o,t)=>{const r=e.profile._id;i.User.findById(e.payload.id).then(n=>n.follow(r).then(()=>o.json({profile:e.profile.toProfileJSONFor(n)}))).catch(t)}),s.delete("/:username/follow",f.authentication.required,(e,o,t)=>{const r=e.profile._id;i.User.findById(e.payload.id).then(n=>n.unfollow(r).then(()=>o.json({profile:e.profile.toProfileJSONFor(n)}))).catch(t)});const N=s;
