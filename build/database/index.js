var f=Object.create,i=Object.defineProperty,g=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty,m=Object.getOwnPropertyNames,a=Object.getOwnPropertyDescriptor,p=o=>i(o,"__esModule",{value:!0}),M=(o,e,u)=>{if(p(o),e&&typeof e=="object"||typeof e=="function")for(let r of m(e))!l.call(o,r)&&r!=="default"&&i(o,r,{get:()=>e[r],enumerable:!(u=a(e,r))||u.enumerable});return o},s=o=>o&&o.__esModule?o:M(i(o!=null?f(g(o)):{},"default",{value:o,enumerable:!0}),o);var t=s(require("mongoose")),n=s(require("../utils/logger")),c=s(require("../utils/secrets"));const d=`mongodb://${c.DB.USER}:${encodeURIComponent(c.DB.PASSWORD)}@${c.DB.HOST}:${c.DB.PORT}/${c.DB.NAME}`,S={useNewUrlParser:!0,useCreateIndex:!0,useUnifiedTopology:!0,useFindAndModify:!1,autoIndex:!0,poolSize:10,bufferMaxEntries:0,connectTimeoutMS:1e4,socketTimeoutMS:45e3};n.default.debug(d),t.default.connect(d,S).then(()=>{n.default.info("Mongoose connection done")}).catch(o=>{n.default.info("Mongoose connection error"),n.default.error(o)}),t.default.connection.on("connected",()=>{n.default.info("Mongoose default connection open to "+d)}),t.default.connection.on("error",o=>{n.default.error("Mongoose default connection error: "+o)}),t.default.connection.on("disconnected",()=>{n.default.info("Mongoose default connection disconnected")}),process.on("SIGINT",()=>{t.default.connection.close(()=>{n.default.info("Mongoose default connection disconnected through app termination"),process.exit(0)})});
