var i=Object.create,t=Object.defineProperty,n=Object.getPrototypeOf,c=Object.prototype.hasOwnProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertyDescriptor,f=r=>t(r,"__esModule",{value:!0}),w=(r,a,e)=>{if(f(r),a&&typeof a=="object"||typeof a=="function")for(let s of u(a))!c.call(r,s)&&s!=="default"&&t(r,s,{get:()=>a[s],enumerable:!(e=d(a,s))||e.enumerable});return r},l=r=>r&&r.__esModule?r:w(t(r!=null?i(n(r)):{},"default",{value:r,enumerable:!0}),r);var o=l(require("passport")),p=l(require("passport-local")),m=l(require("../database/models/user.model"));const g=p.default.Strategy;o.default.use(new g({usernameField:"user[email]",passwordField:"user[password]"},(r,a,e)=>{m.User.findOne({email:r}).then(s=>s?s.validPassword(a)?e(null,s):e(null,!1,{message:"Incorrect password."}):e(null,!1,{message:"Incorrect email."})).catch(e)}));
